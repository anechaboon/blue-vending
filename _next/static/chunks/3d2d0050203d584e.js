(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,11856,e=>{"use strict";let t=e.i(47167).default.env.NEXT_PUBLIC_API_URL;async function s(){let e=await fetch(`${t}/product`,{method:"GET",cache:"no-store"});if(!e.ok)throw Error("Failed to fetch products");return(await e.json()).data}async function r(e){let s=await fetch(`${t}/product`,{method:"POST",body:e});if(!s.ok)throw Error("Failed to create product");return await s.json()}async function l(e,s){let r=await fetch(`${t}/product/${e}`,{method:"PUT",body:s});if(!r.ok)throw Error("Failed to update product");return await r.json()}async function a(e){let s=await fetch(`${t}/product/${e}`,{method:"DELETE"});if(!s.ok)throw Error("Failed to delete product");return await s.json()}e.s(["createProduct",()=>r,"deleteProduct",()=>a,"getProducts",()=>s,"updateProduct",()=>l])},57593,e=>{"use strict";let t=e.i(47167).default.env.NEXT_PUBLIC_API_URL;async function s(e=""){let r=await fetch(`${t}/cash`+e,{method:"GET",cache:"no-store"});if(!r.ok)throw Error("Failed to fetch cashes");return(await r.json()).data}async function r(e){let s=await fetch(`${t}/cash`,{method:"POST",body:e});if(!s.ok)throw Error("Failed to create cash");return await s.json()}async function l(e,s){let r=await fetch(`${t}/cash/${e}`,{method:"PUT",body:s});if(!r.ok)throw Error("Failed to update cash");return await r.json()}async function a(e){let s=await fetch(`${t}/cash/${e}`,{method:"DELETE"});if(!s.ok)throw Error("Failed to delete cash");return await s.json()}e.s(["createCash",()=>r,"deleteCash",()=>a,"getCashes",()=>s,"updateCash",()=>l])},45150,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(47167),l=e.i(11856);let a=r.default.env.NEXT_PUBLIC_IMAGE_URL;function i({onClickProduct:e}){let[r,i]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(0,l.getProducts)().then(e=>i(e))},[]),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6 container mx-auto",children:r.map(s=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden buy-product cursor-pointer",onClick:()=>e(s),children:[(0,t.jsx)("div",{id:"image-preview",className:"w-full h-48 border border-gray-300 rounded bg-gray-100 flex items-center justify-center",children:s.image?(0,t.jsx)("img",{src:`${a}/products/${s.image}`,alt:s.title,className:"max-w-full max-h-full object-contain",onError:e=>{let t=e.currentTarget;t.style.display="none";let s=document.createElement("span");s.className="text-gray-400",s.textContent="Image not found",t.parentElement?.appendChild(s)}}):(0,t.jsx)("span",{className:"text-gray-400",children:"Image not found"})}),(0,t.jsxs)("div",{className:"flex flex-row justify-between mb-4 px-4 pt-3",children:[" ",(0,t.jsx)("h2",{className:"text-2xl font-bold flex-grow basis-0",style:{flex:"0 0 75%"},children:s.title}),(0,t.jsxs)("h2",{className:"text-2xl font-bold flex-shrink-0 text-right",style:{flex:"0 0 25%"},children:[s.price," ฿"]})]})]},s.id))})}var n=e.i(95623),c=e.i(38325);function o({selected:e,onAddToCart:l}){let a=r.default.env.NEXT_PUBLIC_IMAGE_URL,[i,n]=s.default.useState(0);s.default.useEffect(()=>{n(0)},[e]);let o=t=>{if(!(t<0)){if(t>Number(e.stock))return void c.default.fire({icon:"warning",title:"Insufficient Stock",text:`Only ${e.stock} items available in stock.`});n(t)}};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex flex-row justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:e.title}),(0,t.jsxs)("h2",{className:"text-2xl font-bold",children:[e.price," ฿"]})]}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("div",{id:"image-preview",className:"w-full h-48 border border-gray-300 rounded bg-gray-100 bg-center bg-contain flex items-center justify-center",style:{backgroundRepeat:"no-repeat",backgroundImage:e.image?`url(${a}/products/${e.image})`:void 0},children:!e.image&&(0,t.jsx)("span",{className:"text-gray-400",children:"Image not found"})})}),(0,t.jsxs)("div",{className:"flex flex-row justify-between mb-4",children:[(0,t.jsx)("button",{type:"button",className:"px-4 py-2 bg-red-500 text-white text-xl rounded",onClick:()=>o(i-1),children:"-"}),(0,t.jsx)("span",{className:"text-xl font-semibold",children:i}),(0,t.jsx)("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white text-xl rounded",onClick:()=>o(i+1),children:"+"})]}),(0,t.jsx)("div",{className:"flex flex-row justify-center mb-4",children:(0,t.jsxs)("h3",{className:"text-lg font-medium",children:["Total Price: ",Number(e.price)*i," ฿"]})}),(0,t.jsxs)("div",{className:"flex justify-center",children:[(0,t.jsx)("button",{type:"button",className:"mx-2 px-6 py-3 bg-green-600 text-white rounded hover:bg-green-700",onClick:()=>l(e,i),children:"Add To Cart"}),(0,t.jsx)("button",{type:"button",className:"mx-2 px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:()=>l(e,i,!0),children:"Buy Now"})]})]})}function d({cart:e,onUpdateQuantity:s}){return(0,t.jsx)("div",{children:0===e.length?(0,t.jsx)("p",{children:"Your cart is empty."}):(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center w-full mb-8 font-bold",children:[(0,t.jsx)("div",{className:"flex-2",children:"Product"}),(0,t.jsx)("div",{className:"flex-1",children:"Price"}),(0,t.jsx)("div",{className:"flex-1",children:"Quantity"}),(0,t.jsx)("div",{children:"Total"})]})}),e.map(e=>(0,t.jsx)("li",{className:"mb-4",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center w-full mb-4",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center flex-2",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-200 bg-center bg-contain mr-4",style:{backgroundImage:e.image?`url(${r.default.env.NEXT_PUBLIC_IMAGE_URL}/products/${e.image})`:void 0,backgroundRepeat:"no-repeat"}}),(0,t.jsx)("h3",{className:"text-lg font-semibold",children:e.title})]}),(0,t.jsx)("div",{className:"flex-1 ",children:(0,t.jsxs)("span",{className:"text-gray-600 ",children:[e.price," ฿"]})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("button",{className:"px-2 py-1 bg-red-500 text-white rounded mr-2 hover:cursor-pointer",onClick:()=>s(Number(e.id),(e.qty??0)-1),children:"-"}),(0,t.jsx)("span",{className:"text-gray-600",children:e.qty}),(0,t.jsx)("button",{className:"px-2 py-1 bg-green-600 text-white rounded ml-2 hover:cursor-pointer",onClick:()=>s(Number(e.id),(e.qty??0)+1),children:"+"})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("span",{className:"text-gray-600 font-semibold",children:[(e.qty??0)*parseFloat(e.price)," ฿"]})})]})},e.id)),(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-end w-full font-bold",children:[(0,t.jsx)("div",{className:"mr-4",children:"Grand Total:"}),(0,t.jsx)("div",{children:(0,t.jsxs)("span",{className:"text-gray-800 font-semibold",children:[e.reduce((e,t)=>e+(t.qty??0)*parseFloat(t.price),0)," ฿"]})})]})})]})})}var u=e.i(57593);function h({cart:e,totalAmount:r,billReceived:l,coinReceived:a,setBillReceived:i,setCoinReceived:n,totalInserted:o,setTotalInserted:d}){let[h,x]=s.default.useState([]),[f,m]=s.default.useState([]),p=(e,t)=>{o>=r?c.default.fire({icon:"info",title:"Sufficient Cash Inserted",text:"You have already inserted enough cash for this transaction."}):(d(e=>e+t),"BILL"===e&&i(s=>{let r=`${e}${t}`;return{...s,[r]:(s[r]??0)+1}}),"COIN"===e&&n(s=>{let r=`${e}${t}`;return{...s,[r]:(s[r]??0)+1}}))};return s.default.useEffect(()=>{(0,u.getCashes)("?cash_type=BILL").then(e=>x(e)),(0,u.getCashes)("?cash_type=COIN").then(e=>m(e))},[]),(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center w-full mb-8",children:[(0,t.jsx)("h4",{className:"text-2xl font-bold text-center",children:"Insert Cash for "}),(0,t.jsxs)("h2",{className:"text-4xl font-semibold pl-3",children:[r," ฿"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between w-full max-w-5xl mx-auto mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,t.jsxs)("div",{className:"flex items-baseline space-x-2 mr-4",children:[(0,t.jsx)("h4",{className:"text-2xl font-bold",children:"Inserted"}),(0,t.jsxs)("h2",{className:"text-4xl font-semibold",children:[o," ฿"]})]}),(0,t.jsxs)("div",{className:"flex items-baseline space-x-2",style:{marginLeft:"4rem"},children:[(0,t.jsx)("span",{className:"text-1xl font-bold",children:"Left to Insert:"}),(0,t.jsxs)("span",{className:"text-3xl font-semibold",children:[Math.max(0,r-o)," ฿"]})]})]}),(0,t.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",onClick:()=>{i({}),n({}),d(0)},children:"X"})]}),(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:h.map(e=>(0,t.jsx)("div",{className:"flex flex-row items-center p-4 border rounded-lg hover:shadow-md cursor-pointer",onClick:()=>p(e.cash_type,e.cash),children:(0,t.jsxs)("h3",{className:"text-lg font-semibold",children:[e.cash_type," - ",e.cash]})},e.id))})}),(0,t.jsx)("div",{children:(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:f.map(e=>(0,t.jsx)("div",{className:"flex flex-row items-center p-4 border rounded-lg hover:shadow-md cursor-pointer",onClick:()=>p(e.cash_type,e.cash),children:(0,t.jsxs)("h3",{className:"text-lg font-semibold",children:[e.cash_type," - ",e.cash]})},e.id))})})]})}let x=r.default.env.NEXT_PUBLIC_API_URL;async function f(e){let t=await fetch(`${x}/purchase`,{method:"POST",body:e});if(!t.ok)throw Error("Failed to create product");return await t.json()}function m(){let[e,r]=(0,s.useState)(!1),[l,a]=(0,s.useState)(!1),[u,x]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),[b,j]=(0,s.useState)([]),[g,y]=s.default.useState({}),[N,w]=s.default.useState({}),[v,C]=s.default.useState(0),k=b.reduce((e,t)=>e+Number(t.price)*(t.qty??0),0),E=()=>{x(!1),y({}),w({}),C(0)};return(0,t.jsxs)("main",{className:"flex flex-col items-center justify-center min-h-screen p-4 bg-gray-300",children:[(0,t.jsx)("div",{className:"container",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center w-full mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold flex-1 text-center",children:"Blue - Vending"}),(0,t.jsxs)("h2",{className:"text-2xl font-semibold hover:cursor-pointer",onClick:()=>a(!0),children:["Cart Items: ",b.length]})]})}),(0,t.jsx)(i,{onClickProduct:e=>{p(e),r(!0)}}),(0,t.jsx)(n.default,{title:"",width:"600px",open:e,onClose:()=>r(!1),footer:(0,t.jsx)("div",{className:"flex justify-end gap-3",children:(0,t.jsx)("button",{className:"px-4 py-2 bg-gray-300 rounded",onClick:()=>r(!1),children:"Cancel"})}),children:m&&(0,t.jsx)(o,{selected:m,onAddToCart:(e,t,s=!1)=>{t<=0||(j(s=>s.find(t=>t.id===e.id)?s.map(s=>s.id===e.id?{...s,qty:(s.qty??0)+t}:s):[...s,{...e,qty:t}]),r(!1),s?x(!0):c.default.fire({icon:"success",title:"Added to Cart",text:`Added ${t} of "${e.title}" to cart.`}))}})}),(0,t.jsx)(n.default,{title:"Cart Items",width:"600px",open:l,onClose:()=>a(!1),footer:(0,t.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,t.jsx)("button",{className:"px-4 py-2 bg-gray-300 rounded hover:cursor-pointer",onClick:()=>a(!1),children:"Close"}),(0,t.jsx)("button",{className:"px-4 py-2 bg-green-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed hover:cursor-pointer",disabled:0===b.length,onClick:()=>void(0===b.length?c.default.fire({icon:"warning",title:"Cart is empty",text:"Please add items to your cart before checking out."}):(a(!1),x(!0))),children:"Checkout"})]}),children:(0,t.jsx)(d,{cart:b,onUpdateQuantity:(e,t)=>{0===t?c.default.fire({icon:"info",title:"Item Removed",text:"The item has been removed from your cart.",showConfirmButton:!0,showCancelButton:!0}).then(t=>{t.isConfirmed&&j(t=>t.filter(t=>t.id!==e))}):j(s=>s.map(s=>s.id===e?{...s,qty:t}:s))}})}),(0,t.jsx)(n.default,{title:"Checkout",width:"600px",open:u,onClose:()=>E(),footer:(0,t.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,t.jsx)("button",{className:"px-4 py-2 bg-gray-300 rounded hover:cursor-pointer",onClick:()=>E(),children:"Close"}),(0,t.jsx)("button",{className:"px-4 py-2 bg-green-700 text-white rounded disabled:opacity-50 disabled:cursor-not-allowed hover:cursor-pointer",onClick:()=>{let e,t;return e=b.map(e=>({id:e.id,quantity:e.qty??0})),void((t=new FormData).append("product",JSON.stringify(e)),t.append("BILL",JSON.stringify(g)),t.append("COIN",JSON.stringify(N)),f(t).then(e=>{if(!e.status)return void c.default.fire("Error",e.message||"Payment failed","error");let t=[],s=0;if(e.change_bill)for(let[r,l]of(t.push("Change Bills:"),Object.entries(e.change_bill)))s+=Number(r)*Number(l),t.push(`- ${r}: ${l}`);if(e.change_coin)for(let[r,l]of(t.push("Change Coins:"),Object.entries(e.change_coin)))s+=Number(r)*Number(l),t.push(`- ${r}: ${l}`);t.push(`Total: ${s} ฿`),c.default.fire({title:"Success",html:`<pre style="text-align: center;">${t.join("\n")}</pre>`,icon:"success",confirmButtonText:"OK"}).then(()=>{j([]),y({}),w({}),C(0),x(!1)})}).catch(e=>{console.log("Error:",e),c.default.fire("Error","An error occurred during payment","error")}))},disabled:v<k,children:"Confirm Payment"})]}),children:(0,t.jsx)(h,{cart:b,totalAmount:k,billReceived:g,coinReceived:N,setBillReceived:y,setCoinReceived:w,totalInserted:v,setTotalInserted:C})})]})}e.s(["default",()=>m],45150)}]);